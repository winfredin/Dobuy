<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<link rel="stylesheet" th:href="@{/css/member.css}">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/dataTables.jqueryui.min.css" /> <!-- ●●css for jquery datatables 用 -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">




</head>
<body>
    <header>
        <div class="header">

            <div class="logo">
                
                <img src="images/logo noback.png"   alt="logo" class="logo">

                
            </div>
            
            <div class="header_bar">
                <div class="search">
                    
                    <input type="text" placeholder="Search..." class="search" action="">
                
                
                    <button class="search_button" name="search">
                    </button>
                    <img src="images/magnifying-glass-dollar-solid.svg" alt="Search">
            </div>
                <div class="nav_bar">

                    <div class="head"> 
                        <a th:href="@{/home}">Home</a>
						<a th:href="@{/goodspage}">一般商城</a>
						<a th:href="@{/usedgoodspage}">二手商城</a>
                        <div class="dropdown">
						    <a href="#" class="dropdown-btn">櫃位專區</a>
						    <div class="dropdown-content">
						        <a th:each="counterVO : ${counterVOList}"
						           th:href="@{/counter/getOneCounter_For_Display(counterNo=${counterVO.counterNo})}"
						           th:text="${counterVO.counterCName}">
						        </a>
						    </div>
						</div>
                    </div>
                </div>
            </div>

            <div class="icon_area">    
                <div class="icons">
                    
                    <div>
   
    <div class="icons">
    <!-- 當 session.memNo 為 null，添加 login-only 類 -->
    <a class="icons login-only" th:href="@{/mem/login}" th:if="${session.memNo == null}">
				    <img th:src="@{/images/login.png}" alt="Login">
				</a>
				
				<!-- 當 session.memNo 不為 null，顯示其他按鈕 -->
				<a class="icons" th:href="@{/member}" th:if="${session.memNo != null}">
				    <img th:src="@{/images/會員中心.png}" alt="User">
				</a>
				<a class="icons" th:href="@{/mem/logout}" th:if="${session.memNo != null}">
				    <img th:src="@{/images/log-out.png}" alt="Logout">
				</a>
				<a class="icons" th:href="@{/shoppingcartlist/listAllShoppingCartList}" th:if="${session.memNo != null}">
				    <img th:src="@{/images/購物車.png}" alt="Cart">
				</a>
				<a class="icons" th:href="@{/customerservice/addComplaint}" th:if="${session.memNo != null}">
			        <img th:src="@{/images/report.png}" alt="Report">
			    </a>

</div>

</div>

                    
                </div>
                
              
                
            </div>
            
            
            
        </div>
    </header>
     
  

  
    
    <div class="use_body">
        
        <div class="use_list">
            <div class="member_account">
                <div class="mem_img" ><img src="images/會員中心.png" alt="User"> </div>
                <div class="mem_acc"><span>帳號:<pre> </pre>
                   <div class="memac" th:text="${session.memAccount}">  </div></span>
                    <div class="mempro">
                        <svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg" style="margin-right: 4px;"><path d="M8.54 0L6.987 1.56l3.46 3.48L12 3.48M0 8.52l.073 3.428L3.46 12l6.21-6.18-3.46-3.48" fill="#9B9B9B" fill-rule="evenodd"></path>
                        </svg>
                        編輯個人檔案
                    </div>
                </div>
                
            </div>
            <div style="border-top: 1px solid #161515; width: 100%; margin: 2px 0;"></div>
            
            <div class="memthings">
                <div class="pro">
                    <div class="proac title">我的帳戶</div>
                    <div class="prothings">
                        <span id="1" data-id="1">個人檔案</span>
                        <span id="2"data-id="2">更改密碼</span>
                        <span id="3"data-id="3">地址</span>
                        <span id="5"data-id="5">隱私設定</span>
                    </div>
                </div>
                <div class="buy aaa">購買清單</div>
                <div class="twogoods">
                    <div class="two title">二手商品</div>
                    <div class="twothings">
                        <span id="a1">二手商品管理</span>
                        <span id="a2">二手商品訂單(我是買家)</span>
                        <span id="a3">二手商品訂單(我是賣家)</span>
                     </div>
                </div>
                <div class="notice title">通知總覽</div>
                <div class="coupon title">我的優惠券</div>
                <div class="goodsfollow title">我的最愛</div>

            </div>
        </div>

      <div class="member_use">
            <div class="use" >
                <div class="nav_bar">

<!--                     <div class="chos">  -->
<!--                         <div class="aaa" id="b1">全部</div> -->
<!--                         <div  id="b2">待付款</div> -->
<!--                         <div id="b3">待出貨</div> -->
<!--                         <div  id="b4">待收貨</div> -->
<!--                         <div  id="b5">已完成</div> -->
<!--                         <div  id="b6">取消</div> -->
<!--                         <div  id="b7">退款/退貨</div> -->
<!--                     </div> -->
<!--                     <div class="searchtitle"> -->
                        
<!--                         <input class="searchtitle" role="search" autocomplete="off" placeholder="您可以透過賣家名稱，訂單編號或商品名稱搜尋" value=""> -->
<!--                         <img src="/images/magnifying-glass-dollar-solid.svg" alt="Search" class="se"> -->
<!--                     </div> -->

                </div>
                
                    <div class="use_1">
                        <div class="goods" >
                        <div>
  <div>
  <h3>購買訂單</h3> <input type="text" id="orderSearchInput" placeholder="搜尋訂單">
</div>
  
  <!-- 使用訂單編號跑 foreach -->
  <div class="order" th:each="order : ${orders}">
    <div>
      <p><strong>訂單編號:</strong> <span th:text="${order.counterOrderNo}"></span></p>
      
      <p><strong>櫃位名稱:</strong> 
        <span th:each="counterVO : ${counterList}" 
              th:if="${counterVO.counterNo} == ${order.counterNo}" 
              th:text="${counterVO.counterCName}">
        </span>
      </p>
      <p><strong>訂單總額:</strong> <span th:text="${order.orderTotalAfter}"></span></p>
      <p><strong>優惠卷編號:</strong> 
      
        <span th:if="${order.memCouponNo == null}">
		    沒有使用
		</span>
		<span th:each="coupon : ${couponList}" 
		      th:if="${coupon.couponNo == order.memCouponNo}" 
		      th:text="${coupon.couponTitle}">
		</span>
		  <p><strong>櫃位優惠卷名稱:</strong> 
      
        <span th:if="${order.couponNo == null}">
		    沒有使用
		</span>
		<span th:each="newcoupon : ${newcoupon}" 
		      th:if="${newcoupon.couponNo == order.couponNo}" 
		      th:text="${newcoupon.couponTitle}">
		</span>
		</p>

      <p><strong>收件人姓名:</strong> <span th:text="${order.receiverName}"></span></p>
      <p><strong>收件人電話:</strong> <span th:text="${order.receiverPhone}"></span></p>
      <p><strong>收件人地址:</strong> <span th:text="${order.receiverAdr}"></span></p>
      <p><strong>訂單成立時間:</strong> <span th:text="${order.ordertime}"></span></p>
      <p><strong>訂單狀態:</strong> <span th:text="${order.getOrderDisplay}"></span></p>
      
      <!-- 新增的表單部分 -->
        <div th:if="${order.orderStatus} == 1">
            <form action="memOrder" method="post">
                <input type="hidden" name="counterOrderNo" th:value="${order.counterOrderNo}" />
                <button type="submit">通知已收貨</button>
            </form>
        </div>
    </div>

    <h4>訂單明細</h4>
    <table border="1" style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th>商品編號</th>
          <th>商品名稱</th>
          <th>商品數量</th>
          <th>商品單價</th>
          <th>商品總價(折價)</th>
          <th>會員優惠券</th>
          <th>一鍵轉售</th>
        </tr>
      </thead>
<tbody>
  <tr th:each="counterOrderDetailVO : ${order.counterOrderDatailVO}">
    <td th:text="${counterOrderDetailVO.goodsNo}"></td>
    <!-- 簡化商品名稱顯示邏輯 -->
    <td>
      <span th:each="goods : ${goodsNamelist}" 
            th:if="${goods.goodsNo == counterOrderDetailVO.goodsNo}" 
            th:text="${goods.goodsName}">
      </span>
    </td>
    <td th:text="${counterOrderDetailVO.goodsNum}"></td>
    <td th:text="${counterOrderDetailVO.productPrice}"></td>
    <td th:text="${counterOrderDetailVO.productDisPrice}"></td>
    <td>
      <!-- 優惠券顯示也使用相同模式 -->
      <span th:if="${counterOrderDetailVO.memCouponNo == null}">沒有使用</span>
      <span th:each="coupon : ${couponList}" 
            th:if="${coupon.couponNo == counterOrderDetailVO.memCouponNo}" 
            th:text="${coupon.couponTitle}">
      </span>
    </td>
    <td>
      <th:block th:if="${session.memStatus eq 1}">
	  <form method="post" th:action="@{/used/oneButtontoSellUsed}">
	    <input type="submit" value="轉售"/>
	    <input type="hidden" name="goodsNo" th:value="${counterOrderDetailVO.goodsNo}" />
	  </form>
	</th:block>
	<th:block th:if="${session.memStatus eq 2}">
	  <span>被停止賣權，請聯繫客服</span>
	</th:block>
    </td>
  </tr>
</tbody>
    </table>
  </div>
</div>

                         
                        
                        
                        
                        
                        
                        
                        </div>
                    
                     </div>
            </div>
        </div>
    </div>

    <footer>
        <div> © 2024 DO BUY. All Rights Reserved.</div>
    </footer> 


     <script type="text/javascript" th:src="@{/js/jquery3.7.1.js}"></script>
<!-- datatablejs載入 -->
<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script th:src="@{/js/member.js}"></script>




            
            




   

</body>
</html>


